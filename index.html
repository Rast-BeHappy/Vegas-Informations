<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vegas+ | ARZ - Магазин предметов</title>
    <style>
        /* Ваши существующие стили остаются без изменений */
        /* ... */
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <!-- Анимированные частицы фона -->
    <div class="particles" id="particles"></div>

    <!-- Улучшенный загрузочный экран -->
    <div id="loader">
        <!-- Анимированные звезды на фоне -->
        <div class="stars" id="stars"></div>
        
        <!-- Анимированные частицы -->
        <div class="particles-loader" id="particles-loader"></div>
        
        <div class="loader-content">
            <div class="loader-logo">
                <i class="fas fa-gem loader-icon"></i>
                <span class="loader-text">VEGAS+ | ARZ</span>
            </div>
            
            <div class="loader-spinner"></div>
            
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            
            <div class="loader-message" id="loader-message">Инициализация системы...</div>
            
            <div class="loader-success" id="loader-success">
                <i class="fas fa-check-circle"></i>
                <span>Готово! Наслаждайтесь покупками</span>
            </div>
        </div>
    </div>

    <!-- Chatra {literal} -->
    <script>
        (function(d, w, c) {
            w.ChatraID = 'hePBzAxuhW4Nvoz9D';
            var s = d.createElement('script');
            w[c] = w[c] || function() {
                (w[c].q = w[c].q || []).push(arguments);
            };
            s.async = true;
            s.src = 'https://call.chatra.io/chatra.js';
            if (d.head) d.head.appendChild(s);
        })(document, window, 'Chatra');
    </script>
    <!-- /Chatra {/literal} -->

    <div class="container">
        <!-- Верхняя панель -->
        <div class="top-bar">
            <div class="top-links">
                <a href="https://discord.gg/YCg9JXPmCN" class="top-link discord-link" target="_blank">
                    <i class="fab fa-discord"></i>
                    <span>Наш Дискорд</span>
                </a>
                <a href="index2.html" class="top-link sets-link">
                    <i class="fas fa-layer-group"></i>
                    <span>Сэты</span>
                </a>
                <a href="index3.html" class="top-link admin-link">
                    <i class="fas fa-shield-alt"></i>
                    <span>Лавка игроков</span>
                </a>
            </div>
            <button class="account-btn" id="account-btn">
                <i class="fas fa-user"></i>
                <span>Личный кабинет</span>
            </button>
        </div>

        <!-- Основная страница магазина -->
        <div id="main-page">
            <header>
                <div class="logo">
                    <i class="fas fa-shopping-bag logo-icon"></i>
                    <span class="logo-text">VEGAS+ | ARZ</span>
                </div>
                <div class="search-bar">
                    <input type="text" id="search-input" placeholder="Поиск предметов...">
                    <button id="search-btn"><i class="fas fa-search"></i></button>
                </div>
            </header>

            <!-- Фильтры магазина -->
            <div class="filters">
                <div class="filter-group">
                    <label for="category-filter">Категория:</label>
                    <select id="category-filter">
                        <option value="all">Все</option>
                        <option value="skin">Скины</option>
                        <option value="accessory">Аксессуары</option>
                        <option value="vehicle">Транспорт</option>
                        <option value="weapon">Оружие</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="price-filter">Цена:</label>
                    <select id="price-filter">
                        <option value="all">Любая</option>
                        <option value="cheap">До 100,000$</option>
                        <option value="medium">100,000$ - 1,000,000$</option>
                        <option value="expensive">1,000,000$+</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="sort-by">Сортировка:</label>
                    <select id="sort-by">
                        <option value="name-asc">По имени (А-Я)</option>
                        <option value="name-desc">По имени (Я-А)</option>
                        <option value="price-asc">По цене (дешевые)</option>
                        <option value="price-desc">По цене (дорогие)</option>
                        <option value="newest">Сначала новые</option>
                    </select>
                </div>
            </div>

            <!-- Сетка товаров -->
            <div class="items-grid" id="items-grid">
                <!-- Товары будут загружены через JavaScript -->
            </div>

            <!-- Пагинация -->
            <div class="pagination" id="pagination">
                <!-- Пагинация будет сгенерирована через JavaScript -->
            </div>
        </div>
    </div>

    <!-- Модальное окно товара -->
    <div class="modal" id="item-modal">
        <div class="modal-content">
            <span class="close-btn" id="close-modal">&times;</span>
            <div class="modal-body">
                <div class="modal-image" id="modal-image">
                    <img src="" alt="" style="display: none;">
                </div>
                <h2 class="modal-title" id="modal-title">Название предмета</h2>
                <div class="modal-price" id="modal-price">0</div>
                
                <div class="stat-item">
                    <div class="stat-label">Категория</div>
                    <div class="stat-value" id="modal-category">Категория</div>
                </div>
                
                <div class="stat-item">
                    <div class="stat-label">Дата добавления</div>
                    <div class="stat-value" id="modal-date">Дата</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Уведомление -->
    <div class="notification" id="notification">
        <i class="fas fa-info-circle"></i>
        <span id="notification-text">Это пример уведомления</span>
    </div>

    <script>
        // Имитация загрузки
        $(document).ready(function() {
            // Создание звезд для загрузочного экрана
            createStars('#stars', 100);
            // Создание частиц для загрузочного экрана
            createParticles('#particles-loader', 30);
            
            // Имитация прогресса загрузки
            let progress = 0;
            const progressBar = $('#progress-bar');
            const loaderMessages = [
                "Загрузка ресурсов...",
                "Инициализация базы данных...",
                "Подготовка интерфейса...",
                "Почти готово...",
                "Завершение..."
            ];
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                progressBar.css('width', progress + '%');
                
                // Обновление сообщения
                if (progress < 20) {
                    $('#loader-message').text(loaderMessages[0]);
                } else if (progress < 40) {
                    $('#loader-message').text(loaderMessages[1]);
                } else if (progress < 60) {
                    $('#loader-message').text(loaderMessages[2]);
                } else if (progress < 80) {
                    $('#loader-message').text(loaderMessages[3]);
                } else {
                    $('#loader-message').text(loaderMessages[4]);
                }
                
                if (progress === 100) {
                    clearInterval(interval);
                    $('#loader-message').hide();
                    $('.progress-container').hide();
                    $('.loader-spinner').hide();
                    $('#loader-success').fadeIn();
                    
                    setTimeout(() => {
                        $('#loader').fadeOut(800, () => {
                            // Создание частиц для основного фона после загрузки
                            createParticles('#particles', 50);
                            // Загрузка товаров
                            loadItems();
                        });
                    }, 1500);
                }
            }, 300);
            
            // Обработчик закрытия модального окна
            $('#close-modal').click(function() {
                $('#item-modal').fadeOut();
                $('body').css('overflow', 'auto');
            });
            
            // Закрытие модального окна при клике вне его
            $(window).click(function(event) {
                if ($(event.target).is('#item-modal')) {
                    $('#item-modal').fadeOut();
                    $('body').css('overflow', 'auto');
                }
            });
            
            // Обработчик поиска
            $('#search-btn').click(function() {
                filterItems();
            });
            
            $('#search-input').keypress(function(e) {
                if (e.which === 13) {
                    filterItems();
                }
            });
            
            // Обработчики фильтров
            $('#category-filter, #price-filter, #sort-by').change(function() {
                filterItems();
            });
            
            // Обработчик кнопки аккаунта
            $('#account-btn').click(function() {
                showNotification('Вход в личный кабинет');
            });
        });
        
        // Функция загрузки товаров
        function loadItems() {
            // Здесь должен быть AJAX-запрос к вашему prices.json
            // Для примера используем фиктивные данные
            const items = [
                {
                    id: 1,
                    name: "Кожаная куртка",
                    price: 250000,
                    category: "skin",
                    date: "01.06.2023",
                    image: "https://sun9-74.userapi.com/impg/T2QGPg_kceADTIzkKXbpw-CR7EY_s0KC8JwKfQ/0NiamF4FlTs.jpg?size=1000x1000&quality=96&sign=26b090cb0f020401a7da16926066f65a&c_uniq_tag=4B6Bb3xmFZ4GA57O7K7sE-G-QUpqZPVztUXekjssp5w&type=album"
                },
                {
                    id: 2,
                    name: "Золотая цепь",
                    price: 750000,
                    category: "accessory",
                    date: "15.05.2023",
                    image: "https://sun9-74.userapi.com/impg/T2QGPg_kceADTIzkKXbpw-CR7EY_s0KC8JwKfQ/0NiamF4FlTs.jpg?size=1000x1000&quality=96&sign=26b090cb0f020401a7da16926066f65a&c_uniq_tag=4B6Bb3xmFZ4GA57O7K7sE-G-QUpqZPVztUXekjssp5w&type=album"
                },
                {
                    id: 3,
                    name: "Спортивный автомобиль",
                    price: 1500000,
                    category: "vehicle",
                    date: "30.04.2023",
                    image: "https://sun9-74.userapi.com/impg/T2QGPg_kceADTIzkKXbpw-CR7EY_s0KC8JwKfQ/0NiamF4FlTs.jpg?size=1000x1000&quality=96&sign=26b090cb0f020401a7da16926066f65a&c_uniq_tag=4B6Bb3xmFZ4GA57O7K7sE-G-QUpqZPVztUXekjssp5w&type=album"
                },
                {
                    id: 4,
                    name: "Пистолет",
                    price: 500000,
                    category: "weapon",
                    date: "10.05.2023",
                    image: "https://sun9-74.userapi.com/impg/T2QGPg_kceADTIzkKXbpw-CR7EY_s0KC8JwKfQ/0NiamF4FlTs.jpg?size=1000x1000&quality=96&sign=26b090cb0f020401a7da16926066f65a&c_uniq_tag=4B6Bb3xmFZ4GA57O7K7sE-G-QUpqZPVztUXekjssp5w&type=album"
                },
                {
                    id: 5,
                    name: "Черная футболка",
                    price: 150000,
                    category: "skin",
                    date: "05.06.2023",
                    image: "https://sun9-74.userapi.com/impg/T2QGPg_kceADTIzkKXbpw-CR7EY_s0KC8JwKfQ/0NiamF4FlTs.jpg?size=1000x1000&quality=96&sign=26b090cb0f020401a7da16926066f65a&c_uniq_tag=4B6Bb3xmFZ4GA57O7K7sE-G-QUpqZPVztUXekjssp5w&type=album"
                },
                {
                    id: 6,
                    name: "Кроссовки",
                    price: 300000,
                    category: "accessory",
                    date: "12.05.2023",
                    image: "https://sun9-74.userapi.com/impg/T2QGPg_kceADTIzkKXbpw-CR7EY_s0KC8JwKfQ/0NiamF4FlTs.jpg?size=1000x1000&quality=96&sign=26b090cb0f020401a7da16926066f65a&c_uniq_tag=4B6Bb3xmFZ4GA57O7K7sE-G-QUpqZPVztUXekjssp5w&type=album"
                }
            ];
            
            // Сохраняем товары в глобальной переменной
            window.allItems = items;
            
            // Отображаем товары
            displayItems(items);
            
            // Для реального использования раскомментируйте этот код и удалите фиктивные данные выше
            /*
            $.getJSON('prices.json', function(data) {
                window.allItems = data.items;
                displayItems(data.items);
            }).fail(function() {
                showNotification('Ошибка загрузки товаров');
                // Можно показать заглушки или сообщение об ошибке
            });
            */
        }
        
        // Функция отображения товаров
        function displayItems(items) {
            const itemsGrid = $('#items-grid');
            itemsGrid.empty();
            
            if (items.length === 0) {
                itemsGrid.html('<div style="grid-column: 1/-1; text-align: center; padding: 50px; color: var(--text-gray);">Товары не найдены</div>');
                $('#pagination').hide();
                return;
            }
            
            items.forEach(item => {
                const itemCard = $(`
                    <div class="item-card" data-id="${item.id}">
                        <div class="item-image" style="background-image: url('${item.image}')">
                            <img src="${item.image}" alt="${item.name}" style="display: none;">
                        </div>
                        <div class="item-info">
                            <div class="item-name">${item.name}</div>
                            <div class="item-price">${formatPrice(item.price)}</div>
                            <div class="item-updated">
                                <i class="far fa-clock"></i>
                                Обновлено: ${item.date}
                            </div>
                        </div>
                    </div>
                `);
                
                itemCard.click(function() {
                    openItemModal(item);
                });
                
                itemsGrid.append(itemCard);
            });
            
            // Генерация пагинации (упрощенная версия)
            updatePagination();
        }
        
        // Функция открытия модального окна товара
        function openItemModal(item) {
            $('#modal-title').text(item.name);
            $('#modal-price').text(formatPrice(item.price));
            $('#modal-category').text(getCategoryName(item.category));
            $('#modal-date').text(item.date);
            $('#modal-image').css('background-image', `url('${item.image}')`);
            $('#modal-image img').attr('src', item.image).attr('alt', item.name);
            
            $('#item-modal').fadeIn();
            $('body').css('overflow', 'hidden');
        }
        
        // Функция фильтрации товаров
        function filterItems() {
            const searchQuery = $('#search-input').val().toLowerCase();
            const categoryFilter = $('#category-filter').val();
            const priceFilter = $('#price-filter').val();
            const sortBy = $('#sort-by').val();
            
            let filteredItems = window.allItems.filter(item => {
                // Поиск по названию
                const matchesSearch = item.name.toLowerCase().includes(searchQuery);
                
                // Фильтр по категории
                const matchesCategory = categoryFilter === 'all' || item.category === categoryFilter;
                
                // Фильтр по цене
                let matchesPrice = true;
                if (priceFilter === 'cheap') {
                    matchesPrice = item.price <= 100000;
                } else if (priceFilter === 'medium') {
                    matchesPrice = item.price > 100000 && item.price <= 1000000;
                } else if (priceFilter === 'expensive') {
                    matchesPrice = item.price > 1000000;
                }
                
                return matchesSearch && matchesCategory && matchesPrice;
            });
            
            // Сортировка
            filteredItems.sort((a, b) => {
                if (sortBy === 'name-asc') return a.name.localeCompare(b.name);
                if (sortBy === 'name-desc') return b.name.localeCompare(a.name);
                if (sortBy === 'price-asc') return a.price - b.price;
                if (sortBy === 'price-desc') return b.price - a.price;
                if (sortBy === 'newest') return new Date(b.date.split('.').reverse().join('-')) - new Date(a.date.split('.').reverse().join('-'));
                return 0;
            });
            
            displayItems(filteredItems);
            showNotification(`Найдено товаров: ${filteredItems.length}`);
        }
        
        // Функция обновления пагинации
        function updatePagination() {
            // Упрощенная реализация пагинации
            // В реальном проекте нужно учитывать общее количество страниц
            const pagination = $('#pagination');
            pagination.empty();
            
            pagination.append('<button disabled><i class="fas fa-chevron-left"></i></button>');
            pagination.append('<button class="active">1</button>');
            pagination.append('<button>2</button>');
            pagination.append('<button>3</button>');
            pagination.append('<span class="ellipsis">...</span>');
            pagination.append('<button>5</button>');
            pagination.append('<button><i class="fas fa-chevron-right"></i></button>');
            
            // Обработчики для кнопок пагинации
            pagination.find('button:not(:disabled)').click(function() {
                pagination.find('button').removeClass('active');
                $(this).addClass('active');
                // Здесь должна быть логика загрузки соответствующей страницы
            });
        }
        
        // Вспомогательная функция для форматирования цены
        function formatPrice(price) {
            return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // Вспомогательная функция для получения названия категории
        function getCategoryName(category) {
            const categories = {
                'skin': 'Скины',
                'accessory': 'Аксессуары',
                'vehicle': 'Транспорт',
                'weapon': 'Оружие'
            };
            return categories[category] || category;
        }
        
        // Функция создания звезд
        function createStars(container, count) {
            const starsContainer = $(container);
            for (let i = 0; i < count; i++) {
                const star = $('<div class="star"></div>');
                const size = Math.random() * 3;
                const opacity = Math.random() * 0.8 + 0.2;
                const duration = Math.random() * 5 + 3;
                
                star.css({
                    'width': `${size}px`,
                    'height': `${size}px`,
                    'left': `${Math.random() * 100}%`,
                    'top': `${Math.random() * 100}%`,
                    '--opacity': opacity,
                    '--duration': `${duration}s`,
                    'animation-delay': `${Math.random() * 5}s`
                });
                
                starsContainer.append(star);
            }
        }
        
        // Функция создания частиц
        function createParticles(container, count) {
            const particlesContainer = $(container);
            particlesContainer.empty();
            
            for (let i = 0; i < count; i++) {
                const particle = $('<div class="particle-loader"></div>');
                const size = Math.random() * 8 + 2;
                const duration = Math.random() * 15 + 10;
                const delay = Math.random() * 15;
                const x = Math.random() * 100;
                
                particle.css({
                    'width': `${size}px`,
                    'height': `${size}px`,
                    'left': `${x}%`,
                    '--random-x': `${(Math.random() - 0.5) * 200}px`,
                    'animation': `floatUp ${duration}s linear ${delay}s infinite`
                });
                
                particlesContainer.append(particle);
            }
        }
        
        // Функция показа уведомления
        function showNotification(message) {
            const notification = $('#notification');
            $('#notification-text').text(message);
            
            notification.fadeIn();
            setTimeout(() => {
                notification.fadeOut();
            }, 3000);
        }
    </script>
</body>
</html>
